# 📋 מדריך מהיר - לוח ניהול מנהל העל

## 🚀 התקנה מהירה (5 דקות)

### שלב 1: הרצת SQL ב-Supabase

1. **פתחי את Supabase Dashboard:**
   - לכי ל-https://supabase.com/dashboard
   - בחרי את הפרויקט שלך

2. **פתחי SQL Editor:**
   - לחצי על "SQL Editor" בתפריט השמאלי
   - לחצי "+ New Query"

3. **העתיקי והריצי את הקובץ:**
   - פתחי את `CLEAN_SUPABASE_SETUP.sql`
   - **העתיקי הכל**
   - הדביקי ב-SQL Editor
   - **שני את המייל בשורה 266** ל-מייל שלך!
   ```sql
   WHERE email = 'ofirbaranesad@gmail.com';  -- <- שני את זה!
   ```
   - לחצי **"Run"** (או Ctrl+Enter)

4. **וודאי שזה עבד:**
   התוצאה צריכה להיות:
   ```
   ✅ Success. No rows returned
   ```

### שלב 2: בדיקה שאת מנהל-על

הריצי את השאילתה הזו:

```sql
SELECT id, email, username, is_admin, is_super_admin, credits 
FROM users 
WHERE email = 'ofirbaranesad@gmail.com';  -- המייל שלך
```

אמורה להיות תשובה:
```
is_admin: true
is_super_admin: true
role: admin
```

### שלב 3: התנתקי והתחברי מחדש

1. לכי לאפליקציה
2. לחצי על שמך בפינה הימנית
3. "התנתק"
4. התחברי מחדש

---

## 🎛️ איך להשתמש בלוח ניהול

### 1️⃣ לראות את כל המשתמשים

אחרי שנכנסת כמנהל-על:

```
1. לחצי "👨‍💼 ניהול משתמשים" בתפריט העליון
   ↓
2. תראי רשימה של כל המשתמשים:
   
   ╔═══════════════════════════════════╗
   ║ 👥 ניהול משתמשים (5)            ║
   ╚═══════════════════════════════════╝
   
   ┌─────────────────────────────────┐
   │ 👤 שרה כהן (sarah@example.com) │
   │ 💳 50 קרדיטים | 👤 2 פרופילים │
   │ 📚 5 סיפורים | 📝 3 חוברות    │
   │ [ערוך קרדיטים] [🗑️]           │
   └─────────────────────────────────┘
```

### 2️⃣ לערוך קרדיטים למשתמש

```
בכרטיס המשתמש:
   ↓
לחצי על "✏️" ליד הקרדיטים
   ↓
הקלידי מספר חדש (למשל: 100)
   ↓
לחצי ✓ או Enter
   ↓
השינוי מתעדכן מיד! ✅
```

**או:**

```
לחצי על המשתמש בכרטיס
   ↓
נפתח חלון פרטים
   ↓
בטאב "קרדיטים":
   - ראי היסטוריה מלאה
   - הוסיפי או הורידי קרדיטים
```

### 3️⃣ לשלוט בעלויות יצירות

```
למעלה בדף תראי קופסה:
╔══════════════════════════════════════╗
║ ⚙️ שליטה על עלויות יצירות במערכת  ║
╚══════════════════════════════════════╝

📚 חלק בסיפור: 1 💎
🎯 שלב בתוכנית למידה: 2 💎
📄 דף תרגול: 2 💎
📝 חוברת עבודה: 3 💎
💡 הצעות נושאים: 1 💎

[✏️ ערוך עלויות קרדיטים]
```

לחצי "ערוך עלויות" ושני את המספרים!

### 4️⃣ קרדיטים אינסופיים (לבדיקות)

```
למטה תראי:
╔══════════════════════════════════╗
║ 🚀 בקרת מנהל ראשי              ║
║ [⚡ הפעל קרדיטים אינסופיים]   ║
╚══════════════════════════════════╝
```

זה ייתן לך 9,999,999 קרדיטים!

---

## ❓ פתרון בעיות

### ❌ "לא רואה משתמשים"

**בדקי:**
1. האם הרצת את ה-SQL?
   ```sql
   SELECT * FROM users;
   ```
   אמור להראות משתמשים.

2. האם את מנהל-על?
   ```sql
   SELECT is_admin, is_super_admin FROM users WHERE email = 'YOUR_EMAIL';
   ```
   שניהם צריכים להיות `true`.

3. פתחי Console (F12):
   ```
   🔵 AppContext: Loading all users with profiles...
   ✅ AppContext: Loaded all users: 5
   ```

### ❌ "לא יכולה לערוך קרדיטים"

**בדקי:**
1. RLS Policy קיים?
   ```sql
   SELECT * FROM pg_policies WHERE tablename = 'users';
   ```

2. Real-time מופעל?
   ```sql
   SELECT schemaname, tablename FROM pg_publication_tables 
   WHERE pubname = 'supabase_realtime';
   ```
   צריך לכלול `users`.

### ❌ "השינויים לא מתעדכנים"

1. **רעני את הדף** (F5)
2. התנתקי והתחברי מחדש
3. בדקי Console:
   ```
   🔔 AppContext: Users table changed!
   ```

---

## 📊 מה אמור לעבוד

✅ **רשימת משתמשים**
- רואים את כולם
- קרדיטים מעודכנים
- סטטיסטיקות (סיפורים, חוברות)

✅ **עריכת קרדיטים**
- לחיצה על ✏️
- הזנת מספר
- עדכון מיידי

✅ **עלויות יצירות**
- צפייה בעלויות נוכחיות
- עריכה
- שמירה + עדכון לכולם

✅ **Real-time**
- שינוי קרדיטים → עדכון מיידי
- הוספת משתמש → מופיע ברשימה
- עדכון עלויות → כולם רואים

---

## 🔑 הערות חשובות

1. **API Keys:** 
   - כרגע יש מפתח ברירת מחדל אחד
   - כל המשתמשים משתמשים בו
   - אפשר להוסיף עוד מפתחות בעתיד

2. **קרדיטים:**
   - מתעדכנים בזמן אמת
   - היסטוריה נשמרת
   - אפשר להוסיף/להוריד/לאפס

3. **מחיקת משתמש:**
   - מחיקה קבועה!
   - כל התכנים נמחקים
   - **אישור נדרש**

---

## 🎯 סיכום מהיר

```
הרצת SQL ✅
  ↓
שינית מייל ✅
  ↓
Run ✅
  ↓
התנתקת והתחברת ✅
  ↓
ניהול משתמשים → רואה הכל! 🎉
```

**אם משהו לא עובד - פתחי Console (F12) ושלחי לי את השגיאות!**

