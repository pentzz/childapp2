# 📝 יומן שינויים - Change Log

**קובץ זה מכיל את כל השינויים בפרויקט, מסודרים מהחדש לישן.**

**⚠️ לפני כל שינוי - קרא את הקובץ הזה!**  
**📋 הוראות מפורטות: ראה `CHANGE_WORKFLOW.md`**

---

## 📝 רשימת שינויים (מהחדש לישן):

### [2025-11-06] - אופיר ברנס - תיקון טעינת משתמש אחרי רענון - מניעת טעינה אינסופית

**מה שונה:**
- עדכון `src/components/AppContext.tsx` - שיפור טעינת session לפני טעינת משתמש
- הוספת המתנה ל-session לפני טעינת נתוני משתמש
- שיפור timing של טעינת המשתמש כדי למנוע טעינה אינסופית

**למה:**
- אחרי רענון הדף, המערכת לא זיהתה שהמשתמש מחובר
- טעינה אינסופית של דף הבית (LandingPage)
- הבעיה הייתה שה-session לא נטען לפני שהמערכת ניסתה לטעון את המשתמש

**השפעה:**
- ✅ טעינת session לפני טעינת משתמש
- ✅ מניעת טעינה אינסופית של דף הבית
- ✅ זיהוי נכון של משתמש מחובר אחרי רענון
- ✅ שיפור timing של טעינת המשתמש
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שיפור ממשק ניהול מפתחות API - הקצאת מפתחות למשתמשים מרשימה נפתחת

**מה שונה:**
- עדכון `src/components/AdminDashboard.tsx` - הוספת ממשק נוח להקצאת מפתחות API למשתמשים
- כל מפתח API מציג את רשימת המשתמשים המשתמשים בו
- אפשרות להקצות מפתח למשתמש חדש מרשימה נפתחת (בטאב API Keys)
- אפשרות להסיר מפתח ממשתמש
- הצגת רשימת המשתמשים המשתמשים בכל מפתח

**למה:**
- צורך בממשק נוח יותר להקצאת מפתחות API למשתמשים
- צורך לראות איזה משתמשים משתמשים בכל מפתח
- צורך להקצות מפתחות למשתמשים מרשימה נפתחת

**השפעה:**
- ✅ ממשק נוח להקצאת מפתחות API למשתמשים
- ✅ הצגת רשימת המשתמשים המשתמשים בכל מפתח
- ✅ אפשרות להקצות מפתח למשתמש חדש מרשימה נפתחת
- ✅ אפשרות להסיר מפתח ממשתמש
- ✅ ניהול קל יותר של מפתחות API
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון Fallback למפתח גלובאלי - Validation למפתחות API

**מה שונה:**
- עדכון `src/components/AppContext.tsx` - הוספת validation למפתחות API (אורך, placeholder)
- עדכון `src/components/StoryCreator.tsx` - שיפור fallback למפתח גלובאלי אם מפתח המשתמש לא תקף
- עדכון `src/components/WorkbookCreator.tsx` - שיפור fallback למפתח גלובאלי אם מפתח המשתמש לא תקף (בשני המקומות)

**למה:**
- המפתח שהוקצה למשתמש לא תקף (31 תווים) והמערכת לא נפלה למפתח הגלובאלי
- צורך ב-validation למפתחות API כדי לזהות מפתחות לא תקפים
- צורך ב-fallback אוטומטי למפתח גלובאלי אם מפתח המשתמש לא תקף

**השפעה:**
- ✅ Validation אוטומטי למפתחות API - מזהים מפתחות placeholder או קצרים מדי
- ✅ Fallback אוטומטי למפתח גלובאלי אם מפתח המשתמש לא תקף
- ✅ הודעות ברורות בקונסול על איזה מפתח משתמשים
- ✅ המערכת עובדת גם אם מפתח המשתמש לא תקף
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - הוספת אפשרות להגדרת API key לכל משתמש בנפרד

**מה שונה:**
- עדכון `src/components/StoryCreator.tsx` - שימוש ב-API key של המשתמש במקום גלובאלי
- עדכון `src/components/WorkbookCreator.tsx` - שימוש ב-API key של המשתמש במקום גלובאלי (בשני המקומות: InteractiveWorkbook ו-LearningCenter)
- עדכון `src/components/AdminDashboard.tsx` - הוספת UI להגדרת API key לכל משתמש בנפרד בטאב Settings
- כל יצירה (סיפורים, חוברות, תוכניות) עכשיו משתמשת ב-API key של המשתמש הספציפי

**למה:**
- ניהול טוב יותר של מפתחות API - כל משתמש יכול לקבל מפתח משלו
- לא משתמשים במפתח גלובאלי - כל משתמש משתמש במפתח שלו
- ניהול קל יותר של מפתחות API - מנהל על יכול להגדיר מפתח לכל משתמש בנפרד

**השפעה:**
- ✅ כל משתמש משתמש ב-API key שלו (אם מוגדר)
- ✅ Fallback למפתח גלובאלי אם משתמש לא קיבל מפתח
- ✅ UI נוח להגדרת מפתח לכל משתמש ב-Admin Dashboard
- ✅ כל יצירה משתמשת במפתח הנכון
- ❌ אין breaking changes - יש fallback למפתח גלובאלי

---

### [2025-11-06] - אופיר ברנס - תיקון טעינת משתמש אחרי התחברות

**מה שונה:**
- עדכון `src/components/AppContext.tsx`
- שיפור לוגיקה של יצירת משתמש אוטומטית אם לא קיים ב-`public.users`
- הוספת יצירה ידנית של משתמש אם ה-trigger לא עובד
- הגדרה אוטומטית של super admin privileges עבור `ofirbaranesad@gmail.com`
- שיפור error handling בטעינת משתמש

**למה:**
- המשתמש לא נכנס לפאנל אחרי התחברות
- המשתמש לא נוצר אוטומטית ב-`public.users` אחרי התחברות
- צריך יצירה ידנית אם ה-trigger לא עובד

**השפעה:**
- ✅ משתמשים נוצרים אוטומטית אם לא קיימים
- ✅ Super admin מוגדר אוטומטית עבור `ofirbaranesad@gmail.com`
- ✅ טעינת משתמש יותר יציבה
- ✅ פחות שגיאות בטעינת משתמש
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - החזרת טקסט ב-Hero Section לאישית

**מה שונה:**
- עדכון `src/components/HeroSection.tsx`
- החזרת טקסט ברירת מחדל מ-"פלטפורמת למידה ויצירה מותאמת קבוצתית." ל-"פלטפורמת למידה ויצירה מותאמת אישית."

**למה:**
- החזרת מיקוד להתאמה אישית

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page) - Hero Section
- ❌ אין breaking changes

---

### [2025-11-06] - מתוקו מסגנאו - החזרת טקסט כותרת Features למקור

**מה שונה:**
- עדכון `src/components/FeaturesSection.tsx`
- שינוי טקסט ברירת מחדל מ-"מה יש לנו להציע?" חזרה ל-"מה אנחנו מציעים?"

**למה:**
- החזרת הטקסט המקורי לפי בקשת המשתמש

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שינוי טקסט ב-Hero Section

**מה שונה:**
- עדכון `src/components/HeroSection.tsx`
- שינוי טקסט ברירת מחדל מ-"פלטפורמת למידה ויצירה מותאמת אישית." ל-"פלטפורמת למידה ויצירה מותאמת קבוצתית."

**למה:**
- שינוי מיקוד מהתאמה אישית להתאמה קבוצתית

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page) - Hero Section
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - עדכון תהליך עבודה עם Pull מחייב

**מה שונה:**
- עדכון `CHANGE_WORKFLOW.md` - תהליך עבודה מחייב עם Pull לפני כל שלב
- עדכון `README.md` - תהליך עבודה מחייב עם Pull
- עדכון `CURSOR_PROJECT_GUIDE.md` - Checklist מעודכן עם Pull
- הוספת כללים מחייבים: Pull לפני שינוי + Pull לפני Commit
- הוספת אזהרות חזקות על Pull לפני כל שלב
- הוספת Checklist מלא לפני כל שלב

**למה:**
- סנכרון מלא בין שני המשתמשים
- מניעת קונפליקטים בין שינויים
- וידוא שהמערכת תמיד מעודכנת
- תהליך עבודה מסודר ומחייב

**השפעה:**
- ✅ תהליך עבודה מחייב: Pull → קרא → שנה → תעד → Pull → Commit → Push
- ✅ פחות קונפליקטים בין שינויים
- ✅ סנכרון מלא בין שני המשתמשים
- ✅ כללי עבודה מחייבים וברורים
- ⚠️ **חובה Pull לפני כל שינוי!**
- ⚠️ **חובה Pull לפני כל Commit!**
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שינוי טקסט בכותרת Features

**מה שונה:**
- עדכון `src/components/FeaturesSection.tsx`
- שינוי טקסט ברירת מחדל מ-"מה אנחנו מציעים?" ל-"מה יש לנו להציע?"

**למה:**
- שיפור ניסוח הטקסט ליותר טבעי וידידותי

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - ארגון מחדש של מערכת התיעוד ושיפור זיהוי משתמש

**מה שונה:**
- יצירת קובץ `CHANGE_WORKFLOW.md` עם כל ההוראות והתהליכים
- עדכון `CHANGELOG.md` - רק רשימת שינויים (בלי הוראות)
- יצירת סקריפטים `get-user-name.ps1` ו-`get-user-name.sh` לזיהוי אוטומטי של משתמש
- עדכון `CURSOR_PROJECT_GUIDE.md` ו-`README.md` להפנות ל-`CHANGE_WORKFLOW.md`
- מערכת זיהוי אוטומטית של משתמש לפי מחשב (COMPUTERNAME/USERNAME)
- עדכון תאריכים לתאריך הנוכחי (2025-11-06)

**למה:**
- סדר וניקיון - הפרדה בין הוראות לשינויים
- זיהוי אוטומטי של משתמש - לא צריך להגדיר ידנית
- תאריכים מדויקים
- קל יותר לניהול - כל סוג מידע בקובץ נפרד

**השפעה:**
- ✅ `CHANGELOG.md` נקי ומסודר כעת (רק שינויים)
- ✅ `CHANGE_WORKFLOW.md` מכיל את כל ההוראות
- ✅ זיהוי אוטומטי של משתמש לפי מחשב
- ✅ סקריפטים לזיהוי משתמש (Windows + Linux/Mac)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שינוי טקסט בכותרת Features

**מה שונה:**
- עדכון `src/components/FeaturesSection.tsx`
- שינוי טקסט ברירת מחדל מ-"מה אפשר להציע לך" ל-"מה אנחנו מציעים?"

**למה:**
- שיפור ניסוח הטקסט ליותר מקצועי וידידותי

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון כפילות ב-CHANGELOG

**מה שונה:**
- הסרת כפילות ב-`CHANGELOG.md`
- ניקוי הקובץ מכניסות כפולות

**למה:**
- תיקון שגיאת עריכה

**השפעה:**
- ✅ הקובץ נקי כעת
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - הוספת מערכת תיעוד שינויים מחייבת (2 משתמשים)

**מה שונה:**
- יצירת קובץ `CHANGELOG.md` לתיעוד שינויים בזמן אמת
- עדכון `CURSOR_PROJECT_GUIDE.md` עם הוראות מחייבות לתיעוד שינויים
- יצירת `README.md` עם הוראות מחייבות בכניסה לפרויקט
- יצירת `.gitmessage` - Git Commit Template להזכרת תיעוד
- הוספת תהליך עבודה מחייב: קריאת CHANGELOG לפני כל שינוי + תיעוד לפני כל Commit
- הגדרת Git Commit Template

**למה:**
- שני משתמשים עובדים על הפרויקט (אופיר ברנס ומתוקו מסגנאו)
- צריך לדעת מה שונה, על ידי מי, ולמה
- צריך למנוע התנגשויות בין שינויים
- צריך מערכת תיעוד חזקה ומחייבת

**השפעה:**
- ✅ כל שינוי מתועד כעת
- ✅ שני המשתמשים יכולים לראות שינויים בזמן אמת
- ✅ פחות התנגשויות בין שינויים
- ⚠️ **חובה לקרוא CHANGELOG לפני כל שינוי!**
- ⚠️ **חובה לתיעד ב-CHANGELOG לפני כל Commit!**

---

### [2025-11-06] - אופיר ברנס - תיקון API Key loading

**מה שונה:**
- עדכון `vite.config.ts` לקריאת `VITE_GEMINI_API_KEY` מ-`.env.production`
- עדכון `deploy-vite-project.sh` ליצירת `.env.production` לפני Build
- הוספת debug logging ב-`StoryCreator.tsx` ו-`WorkbookCreator.tsx`

**למה:**
- API Key לא נטען נכון ב-Production
- Vite לא קרא את משתני הסביבה ב-Build time

**השפעה:**
- ✅ API Key נטען נכון כעת
- ✅ צריך Deploy מחדש
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון Redirect URL אחרי התחברות

**מה שונה:**
- עדכון `LoginModal.tsx` לשימוש בכתובת המלאה (origin + pathname + hash) במקום רק origin
- יצירת `SUPABASE_REDIRECT_FIX.md` עם הוראות לעדכון Supabase Dashboard

**למה:**
- אחרי התחברות, המשתמש הועבר ל-`localhost:3000` במקום לכתובת השרת

**השפעה:**
- ✅ Redirect עובד נכון כעת
- ✅ צריך לעדכן Redirect URLs ב-Supabase Dashboard
- ❌ אין breaking changes

---
