# 📝 יומן שינויים - Change Log

**קובץ זה מכיל את כל השינויים בפרויקט, מסודרים מהחדש לישן.**

**⚠️ לפני כל שינוי - קרא את הקובץ הזה!**  
**📋 הוראות מפורטות: ראה `CHANGE_WORKFLOW.md`**

---

## 📝 רשימת שינויים (מהחדש לישן):

### [2025-11-06] - אופיר ברנס - תיקון שימוש ב-API Key של משתמש בפועל

**מה שונה:**
- עדכון `src/components/StoryCreator.tsx`
- עדכון `src/components/WorkbookCreator.tsx`
- שינוי הקריאה ל-Gemini API להשתמש ב-`getUserAPIKey()` במקום `process.env.API_KEY` ישירות
- שימוש ב-`useMemo` כדי ליצור `GoogleGenAI` instance מחדש כשהמשתמש משנה API key
- Fallback ל-global API key אם למשתמש אין API key מוגדר

**למה:**
- כשמנהל העל משנה את ה-API key למשתמש, זה לא השפיע בפועל על הקריאות ל-API
- הקוד השתמש ב-`process.env.API_KEY` ישירות במקום להשתמש ב-API key של המשתמש
- צריך לוודא שהמשתמש משתמש ב-API key שלו (או ב-global אם לא הוגדר)

**השפעה:**
- ✅ כל משתמש משתמש ב-API key שלו בפועל (או ב-global אם לא הוגדר)
- ✅ כשמנהל העל משנה את ה-API key למשתמש, זה משתנה מיד בפועל
- ✅ ה-`GoogleGenAI` instance נוצר מחדש כשהמשתמש משנה API key
- ✅ המערכת עובדת כמו קודם - ללא תקלות
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון redirect אחרי התחברות

**מה שונה:**
- עדכון `src/components/App.tsx`
- עדכון `src/components/AppContext.tsx`
- שיפור טעינת משתמש אחרי OAuth redirect
- ניקוי URL hash אחרי התחברות מוצלחת
- טיפול נכון ב-auth state changes

**למה:**
- אחרי התחברות המשתמש חזר לדף הבית במקום להיכנס לממשק המשתמש
- המשתמש לא נטען נכון אחרי OAuth redirect
- צריך לוודא שהמשתמש נטען מיד אחרי ההתחברות

**השפעה:**
- ✅ המשתמש נכנס לממשק המשתמש מיד אחרי התחברות
- ✅ טעינת משתמש יותר יציבה אחרי OAuth redirect
- ✅ ניקוי URL hash אחרי התחברות מוצלחת
- ✅ טיפול נכון ב-auth state changes
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - הוספת אפשרות להגדיר API Key לכל משתמש בנפרד

**מה שונה:**
- עדכון `src/components/AdminDashboard.tsx`
- הוספת ממשק לבחירת API Key לכל משתמש בטאב "סקירה כללית"
- הצגת מפתח API נוכחי של המשתמש
- אפשרות לבחור מפתח API חדש מהרשימה
- עדכון אוטומטי של המשתמש לאחר בחירת מפתח
- אם לא נבחר מפתח - המשתמש ישתמש במפתח הגלובאלי

**למה:**
- מנהל העל צריך יכולת להגדיר API Key לכל משתמש בנפרד
- כל משתמש צריך להשתמש ב-API Key שלו ולא במפתח הגלובאלי
- זה עובד בדיוק כמו שהמערכת עובדת עכשיו - ללא תקלות

**השפעה:**
- ✅ מנהל העל יכול להגדיר API Key לכל משתמש בנפרד
- ✅ כל משתמש משתמש ב-API Key שלו (או במפתח הגלובאלי אם לא הוגדר)
- ✅ מערכת יציבה ללא תקלות
- ✅ ממשק נוח וקל לשימוש
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון טעינת משתמש אחרי התחברות

**מה שונה:**
- עדכון `src/components/AppContext.tsx`
- שיפור לוגיקה של יצירת משתמש אוטומטית אם לא קיים ב-`public.users`
- הוספת יצירה ידנית של משתמש אם ה-trigger לא עובד
- הגדרה אוטומטית של super admin privileges עבור `ofirbaranesad@gmail.com`
- שיפור error handling בטעינת משתמש

**למה:**
- המשתמש לא נכנס לפאנל אחרי התחברות
- המשתמש לא נוצר אוטומטית ב-`public.users` אחרי התחברות
- צריך יצירה ידנית אם ה-trigger לא עובד

**השפעה:**
- ✅ משתמשים נוצרים אוטומטית אם לא קיימים
- ✅ Super admin מוגדר אוטומטית עבור `ofirbaranesad@gmail.com`
- ✅ טעינת משתמש יותר יציבה
- ✅ פחות שגיאות בטעינת משתמש
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - החזרת טקסט ב-Hero Section לאישית

**מה שונה:**
- עדכון `src/components/HeroSection.tsx`
- החזרת טקסט ברירת מחדל מ-"פלטפורמת למידה ויצירה מותאמת קבוצתית." ל-"פלטפורמת למידה ויצירה מותאמת אישית."

**למה:**
- החזרת מיקוד להתאמה אישית

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page) - Hero Section
- ❌ אין breaking changes

---

### [2025-11-06] - מתוקו מסגנאו - החזרת טקסט כותרת Features למקור

**מה שונה:**
- עדכון `src/components/FeaturesSection.tsx`
- שינוי טקסט ברירת מחדל מ-"מה יש לנו להציע?" חזרה ל-"מה אנחנו מציעים?"

**למה:**
- החזרת הטקסט המקורי לפי בקשת המשתמש

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שינוי טקסט ב-Hero Section

**מה שונה:**
- עדכון `src/components/HeroSection.tsx`
- שינוי טקסט ברירת מחדל מ-"פלטפורמת למידה ויצירה מותאמת אישית." ל-"פלטפורמת למידה ויצירה מותאמת קבוצתית."

**למה:**
- שינוי מיקוד מהתאמה אישית להתאמה קבוצתית

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page) - Hero Section
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - עדכון תהליך עבודה עם Pull מחייב

**מה שונה:**
- עדכון `CHANGE_WORKFLOW.md` - תהליך עבודה מחייב עם Pull לפני כל שלב
- עדכון `README.md` - תהליך עבודה מחייב עם Pull
- עדכון `CURSOR_PROJECT_GUIDE.md` - Checklist מעודכן עם Pull
- הוספת כללים מחייבים: Pull לפני שינוי + Pull לפני Commit
- הוספת אזהרות חזקות על Pull לפני כל שלב
- הוספת Checklist מלא לפני כל שלב

**למה:**
- סנכרון מלא בין שני המשתמשים
- מניעת קונפליקטים בין שינויים
- וידוא שהמערכת תמיד מעודכנת
- תהליך עבודה מסודר ומחייב

**השפעה:**
- ✅ תהליך עבודה מחייב: Pull → קרא → שנה → תעד → Pull → Commit → Push
- ✅ פחות קונפליקטים בין שינויים
- ✅ סנכרון מלא בין שני המשתמשים
- ✅ כללי עבודה מחייבים וברורים
- ⚠️ **חובה Pull לפני כל שינוי!**
- ⚠️ **חובה Pull לפני כל Commit!**
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שינוי טקסט בכותרת Features

**מה שונה:**
- עדכון `src/components/FeaturesSection.tsx`
- שינוי טקסט ברירת מחדל מ-"מה אנחנו מציעים?" ל-"מה יש לנו להציע?"

**למה:**
- שיפור ניסוח הטקסט ליותר טבעי וידידותי

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - ארגון מחדש של מערכת התיעוד ושיפור זיהוי משתמש

**מה שונה:**
- יצירת קובץ `CHANGE_WORKFLOW.md` עם כל ההוראות והתהליכים
- עדכון `CHANGELOG.md` - רק רשימת שינויים (בלי הוראות)
- יצירת סקריפטים `get-user-name.ps1` ו-`get-user-name.sh` לזיהוי אוטומטי של משתמש
- עדכון `CURSOR_PROJECT_GUIDE.md` ו-`README.md` להפנות ל-`CHANGE_WORKFLOW.md`
- מערכת זיהוי אוטומטית של משתמש לפי מחשב (COMPUTERNAME/USERNAME)
- עדכון תאריכים לתאריך הנוכחי (2025-11-06)

**למה:**
- סדר וניקיון - הפרדה בין הוראות לשינויים
- זיהוי אוטומטי של משתמש - לא צריך להגדיר ידנית
- תאריכים מדויקים
- קל יותר לניהול - כל סוג מידע בקובץ נפרד

**השפעה:**
- ✅ `CHANGELOG.md` נקי ומסודר כעת (רק שינויים)
- ✅ `CHANGE_WORKFLOW.md` מכיל את כל ההוראות
- ✅ זיהוי אוטומטי של משתמש לפי מחשב
- ✅ סקריפטים לזיהוי משתמש (Windows + Linux/Mac)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - שינוי טקסט בכותרת Features

**מה שונה:**
- עדכון `src/components/FeaturesSection.tsx`
- שינוי טקסט ברירת מחדל מ-"מה אפשר להציע לך" ל-"מה אנחנו מציעים?"

**למה:**
- שיפור ניסוח הטקסט ליותר מקצועי וידידותי

**השפעה:**
- ✅ הטקסט משתנה רק אם אין תוכן מותאם אישית (CMS)
- ✅ משפיע על דף הבית (Landing Page)
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון כפילות ב-CHANGELOG

**מה שונה:**
- הסרת כפילות ב-`CHANGELOG.md`
- ניקוי הקובץ מכניסות כפולות

**למה:**
- תיקון שגיאת עריכה

**השפעה:**
- ✅ הקובץ נקי כעת
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - הוספת מערכת תיעוד שינויים מחייבת (2 משתמשים)

**מה שונה:**
- יצירת קובץ `CHANGELOG.md` לתיעוד שינויים בזמן אמת
- עדכון `CURSOR_PROJECT_GUIDE.md` עם הוראות מחייבות לתיעוד שינויים
- יצירת `README.md` עם הוראות מחייבות בכניסה לפרויקט
- יצירת `.gitmessage` - Git Commit Template להזכרת תיעוד
- הוספת תהליך עבודה מחייב: קריאת CHANGELOG לפני כל שינוי + תיעוד לפני כל Commit
- הגדרת Git Commit Template

**למה:**
- שני משתמשים עובדים על הפרויקט (אופיר ברנס ומתוקו מסגנאו)
- צריך לדעת מה שונה, על ידי מי, ולמה
- צריך למנוע התנגשויות בין שינויים
- צריך מערכת תיעוד חזקה ומחייבת

**השפעה:**
- ✅ כל שינוי מתועד כעת
- ✅ שני המשתמשים יכולים לראות שינויים בזמן אמת
- ✅ פחות התנגשויות בין שינויים
- ⚠️ **חובה לקרוא CHANGELOG לפני כל שינוי!**
- ⚠️ **חובה לתיעד ב-CHANGELOG לפני כל Commit!**

---

### [2025-11-06] - אופיר ברנס - תיקון API Key loading

**מה שונה:**
- עדכון `vite.config.ts` לקריאת `VITE_GEMINI_API_KEY` מ-`.env.production`
- עדכון `deploy-vite-project.sh` ליצירת `.env.production` לפני Build
- הוספת debug logging ב-`StoryCreator.tsx` ו-`WorkbookCreator.tsx`

**למה:**
- API Key לא נטען נכון ב-Production
- Vite לא קרא את משתני הסביבה ב-Build time

**השפעה:**
- ✅ API Key נטען נכון כעת
- ✅ צריך Deploy מחדש
- ❌ אין breaking changes

---

### [2025-11-06] - אופיר ברנס - תיקון Redirect URL אחרי התחברות

**מה שונה:**
- עדכון `LoginModal.tsx` לשימוש בכתובת המלאה (origin + pathname + hash) במקום רק origin
- יצירת `SUPABASE_REDIRECT_FIX.md` עם הוראות לעדכון Supabase Dashboard

**למה:**
- אחרי התחברות, המשתמש הועבר ל-`localhost:3000` במקום לכתובת השרת

**השפעה:**
- ✅ Redirect עובד נכון כעת
- ✅ צריך לעדכן Redirect URLs ב-Supabase Dashboard
- ❌ אין breaking changes

---
